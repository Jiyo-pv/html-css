<!DOCTYPE html>
<html>
<head>
    <title>Keyless Weather App</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding: 40px; background: #eef2f3; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 350px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #output { margin-top: 25px; padding-top: 20px; border-top: 1px solid #eee; display: none; }
        .data-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .val { font-weight: bold; color: #2c3e50; }
    </style>
</head>
<body>

<div class="container">
    <h2>Weather Finder</h2>
    <input type="text" id="cityInput" placeholder="Enter city (e.g., Tokyo)">
    <button onclick="getWeather()">Check Weather</button>

    <div id="output">
        <h3 id="displayCity">---</h3>
        <div class="data-row"><span>Temperature:</span> <span class="val" id="temp">--</span></div>
        <div class="data-row"><span>Condition:</span> <span class="val" id="cond">--</span></div>
        <div class="data-row"><span>Humidity:</span> <span class="val" id="hum">--</span></div>
        <div class="data-row"><span>Wind Speed:</span> <span class="val" id="wind">--</span></div>
    </div>
</div>

<script>
async function getWeather() {
    const city = document.getElementById('cityInput').value;
    if (!city) return alert("Please enter a city");

    try {
        // Step 1: Geocoding (Convert City Name to Lat/Lon) - NO KEY REQUIRED
        const geoUrl = `https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=en&format=json`;
        const geoRes = await fetch(geoUrl);
        const geoData = await geoRes.json();

        if (!geoData.results) throw new Error("City not found");
        
        const { latitude, longitude, name, country } = geoData.results[0];

        // Step 2: Fetch Weather using Coordinates - NO KEY REQUIRED
        const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&wind_speed_unit=ms`;
        const weatherRes = await fetch(weatherUrl);
        const weatherData = await weatherRes.json();

        // Step 3: Display Data
        const current = weatherData.current;
        document.getElementById('output').style.display = 'block';
        document.getElementById('displayCity').innerText = `${name}, ${country}`;
        document.getElementById('temp').innerText = `${current.temperature_2m}Â°C`;
        document.getElementById('hum').innerText = `${current.relative_humidity_2m}%`;
        document.getElementById('wind').innerText = `${current.wind_speed_10m} m/s`;
        document.getElementById('cond').innerText = getWeatherDesc(current.weather_code);

    } catch (err) {
        alert(err.message);
    }
}

// Open-Meteo uses WMO codes for weather, this helper converts them to text
function getWeatherDesc(code) {
    const codes = {
        0: "Clear Sky", 1: "Mainly Clear", 2: "Partly Cloudy", 3: "Overcast",
        45: "Foggy", 51: "Light Drizzle", 61: "Slight Rain", 71: "Slight Snow",
        95: "Thunderstorm"
    };
    return codes[code] || "Variable";
}
</script>

</body>
</html>